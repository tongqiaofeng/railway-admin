{"remainingRequest":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\aa-tong\\my-projects\\railway-admin\\src\\components\\TreeTable\\tree.vue?vue&type=style&index=1&id=05ec232d&scoped=true&lang=css&","dependencies":[{"path":"D:\\aa-tong\\my-projects\\railway-admin\\src\\components\\TreeTable\\tree.vue","mtime":1610940283705},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tcy10cmVlLXNwYWNlIHsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgdG9wOiAxcHg7CiAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogIGZvbnQtc3R5bGU6IG5vcm1hbDsKICBmb250LXdlaWdodDogNDAwOwogIGxpbmUtaGVpZ2h0OiAxOwogIHdpZHRoOiAxOHB4OwogIGhlaWdodDogMTRweDsKfQoKLm1zLXRyZWUtc3BhY2U6OmJlZm9yZSB7CiAgY29udGVudDogIiI7Cn0KCi5wcm9jZXNzQ29udGFpbmVyIHsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7Cn0KCnRhYmxlIHRkIHsKICBsaW5lLWhlaWdodDogMjZweDsKfQoKLnRyZWUtY3RybCB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIGN1cnNvcjogcG9pbnRlcjsKICBjb2xvcjogIzIxOTZmMzsKICBtYXJnaW4tbGVmdDogLTE4cHg7Cn0K"},{"version":3,"sources":["tree.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"tree.vue","sourceRoot":"src/components/TreeTable","sourcesContent":["<template>\r\n  <el-table ref=\"multipleTable\" :data=\"formatData\" :row-style=\"showRow\" v-bind=\"$attrs\">\r\n    <!--  @header-click=\"chooseall\" -->\r\n    <el-table-column :render-header=\"renderHeader\" width=\"50\" align=\"center\">\r\n      <template slot-scope=\"scope\">\r\n        <el-checkbox v-model=\"scope.row.checks\" @change=\"toselect(scope.row)\"></el-checkbox>\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column v-if=\"columns.length===0\" width=\"150\">\r\n      <template slot-scope=\"scope\">\r\n        <span v-for=\"space in scope.row._level\" :key=\"space\" class=\"ms-tree-space\" />\r\n        <span v-if=\"iconShow(0,scope.row)\" class=\"tree-ctrl\" @click=\"toggleExpanded(scope.$index)\">\r\n          <i v-if=\"!scope.row._expanded\" class=\"el-icon-plus\" />\r\n          <i v-else class=\"el-icon-minus\" />\r\n        </span>\r\n        {{ scope.$index }}\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column v-for=\"(column, index) in columns\" v-else :key=\"column.value\" :label=\"column.text\"\r\n      :width=\"column.width\">\r\n      <template slot-scope=\"scope\">\r\n        <!-- Todo -->\r\n        <!-- eslint-disable-next-line vue/no-confusing-v-for-v-if -->\r\n        <span v-if=\"index === 0\"><span v-for=\"space in scope.row._level\" :key=\"space\" class=\"ms-tree-space\" /></span>\r\n        <span v-if=\"iconShow(index,scope.row)\" class=\"tree-ctrl\" @click=\"toggleExpanded(scope.$index)\">\r\n          <i v-if=\"!scope.row._expanded\" class=\"el-icon-plus\" />\r\n          <i v-else class=\"el-icon-minus\" />\r\n        </span>\r\n        {{ scope.row[column.value] }}\r\n      </template>\r\n    </el-table-column>\r\n    <slot />\r\n  </el-table>\r\n</template>\r\n\r\n<script>\r\n  /**\r\n  Auth: Lei.j1ang\r\n  Created: 2018/1/19-13:59\r\n*/\r\n  import treeToArray from \"./eval\";\r\n  export default {\r\n    name: \"TreeTable\",\r\n    data() {\r\n      return {\r\n        chooseson: true, //全选\r\n        key: true //单个点击直到全部选中\r\n      };\r\n    },\r\n    props: {\r\n      /* eslint-disable */\r\n      data: {\r\n        type: [Array, Object],\r\n        required: true\r\n      },\r\n      columns: {\r\n        type: Array,\r\n        default: () => []\r\n      },\r\n      evalFunc: Function,\r\n      evalArgs: Array,\r\n      expandAll: {\r\n        type: Boolean,\r\n        default: false\r\n      }\r\n    },\r\n    computed: {\r\n      // 格式化数据源\r\n      formatData: function () {\r\n        let tmp;\r\n        if (!Array.isArray(this.data)) {\r\n          tmp = [this.data];\r\n        } else {\r\n          tmp = this.data;\r\n        }\r\n        const func = this.evalFunc || treeToArray;\r\n        const args = this.evalArgs ? [tmp, this.expandAll].concat(this.evalArgs) : [tmp, this.expandAll];\r\n        return func.apply(null, args);\r\n      }\r\n    },\r\n    methods: {\r\n      showRow: function (row) {\r\n        const show = row.row.parent ?\r\n          row.row.parent._expanded && row.row.parent._show :\r\n          true;\r\n        row.row._show = show;\r\n        return show ?\r\n          \"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;\" :\r\n          \"display:none;\";\r\n      },\r\n      // 切换下级是否展开\r\n      toggleExpanded: function (trIndex) {\r\n        const record = this.formatData[trIndex];\r\n        record._expanded = !record._expanded;\r\n      },\r\n      // 图标显示\r\n      iconShow(index, record) {\r\n        return index === 0 && record.child && record.child.length > 0;\r\n      },\r\n\r\n      //设置表头全选\r\n      renderHeader(h, data) {\r\n        return h(\"span\", [\r\n          h(\"input\", {\r\n            attrs: {\r\n              id: \"chooseall\",\r\n              type: \"checkbox\",\r\n              style: \"border: 1px solid #dcdfe6;border-radius: 2px;box-sizing: border-box;width: 14px;height: 14px;background-color: #fff;\"\r\n            }\r\n          })\r\n        ]);\r\n      },\r\n      //功能函数:选中部分子集\r\n      setchildtobeselect(arr, key) {\r\n        arr.forEach((v, i) => {\r\n          v.checks = key;\r\n          // v._expanded = key;//选中后展开子项\r\n          if (v.child) {\r\n            this.setchildtobeselect(v.child, v.checks);\r\n          }\r\n        });\r\n      },\r\n      //是否所有的都被选中\r\n      isallchecked(arr) {\r\n        arr.forEach((v, i) => {\r\n          if (!v.checks) {\r\n            this.key = false;\r\n          }\r\n          if (v.child) {\r\n            this.isallchecked(v.child);\r\n          }\r\n        });\r\n      },\r\n      //设置父级为 未选中状态（父级的父级没改变-有bug）\r\n      setparentfalse(arr, id, level) {\r\n        arr.forEach((v, i) => {\r\n          if (v._level == level - 1 && v.child) {\r\n            v.child.forEach((val, ind) => {\r\n              if (val.id == id) {\r\n                v.checks = false;\r\n                return false; //终止此次循环，减少循环次数\r\n              }\r\n            });\r\n          }\r\n          if (v.child) {\r\n            this.setparentfalse(v.child, id, level);\r\n          }\r\n        });\r\n      },\r\n      //设置父级为 选中状态\r\n      setparenttrue(arr, id, level) {\r\n        arr.forEach((v, i) => {\r\n          if (v._level == level - 1 && v.child) {\r\n            let key = true;\r\n            let sameidkey = false;\r\n            v.child.forEach((val, ind) => {\r\n              if (val.id == id) {\r\n                //确保当前点击的在该父级内\r\n                sameidkey = true;\r\n              }\r\n              if (!val.checks) {\r\n                key = false;\r\n              }\r\n            });\r\n            if (key && sameidkey) {\r\n              v.checks = true;\r\n            }\r\n          }\r\n          if (v.child) {\r\n            this.setparentfalse(v.child, id, level);\r\n          }\r\n        });\r\n      },\r\n      //某个复选框被点击时\r\n      toselect(row) {\r\n        console.log(row);\r\n        // row._expanded = row.checks;//选中后是否展开\r\n        //1、若有子集先让子选中\r\n        if (row.child) {\r\n          this.setchildtobeselect(row.child, row.checks);\r\n        }\r\n        //2、然后判断是否全选中\r\n        this.key = true; //重置为true，防止上次已经是false的状态\r\n        this.isallchecked(this.formatData);\r\n        //3、设置多选框的状态\r\n        if (!row.checks) {\r\n          this.setparentfalse(this.formatData, row.id, row._level); //设置父级选中的状态为false\r\n          document.getElementById(\"chooseall\").checked = false; //设置全选框的状态\r\n        } else {\r\n          this.setparenttrue(this.formatData, row.id, row._level); //设置父级选中的状态为true\r\n        }\r\n        if (this.key) {\r\n          document.getElementById(\"chooseall\").checked = true; //设置全选框的状态\r\n        }\r\n      }\r\n    },\r\n    mounted() {\r\n      this.$nextTick(() => {\r\n        var that = this;\r\n        const all = document.getElementById(\"chooseall\");\r\n        all.onchange = function (e) {\r\n          console.log(all.checked);\r\n          if (all.checked == true) {\r\n            that.setchildtobeselect(that.formatData, true);\r\n          } else {\r\n            that.setchildtobeselect(that.formatData, false);\r\n          }\r\n        };\r\n      });\r\n    }\r\n  };\r\n</script>\r\n<style rel=\"stylesheet/css\">\r\n  @keyframes treeTableShow {\r\n    from {\r\n      opacity: 0;\r\n    }\r\n\r\n    to {\r\n      opacity: 1;\r\n    }\r\n  }\r\n\r\n  @-webkit-keyframes treeTableShow {\r\n    from {\r\n      opacity: 0;\r\n    }\r\n\r\n    to {\r\n      opacity: 1;\r\n    }\r\n  }\r\n</style>\r\n\r\n<style scoped>\r\n  .ms-tree-space {\r\n    position: relative;\r\n    top: 1px;\r\n    display: inline-block;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n    line-height: 1;\r\n    width: 18px;\r\n    height: 14px;\r\n  }\r\n\r\n  .ms-tree-space::before {\r\n    content: \"\";\r\n  }\r\n\r\n  .processContainer {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  table td {\r\n    line-height: 26px;\r\n  }\r\n\r\n  .tree-ctrl {\r\n    position: relative;\r\n    cursor: pointer;\r\n    color: #2196f3;\r\n    margin-left: -18px;\r\n  }\r\n</style>"]}]}