{"remainingRequest":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\aa-tong\\my-projects\\railway-admin\\src\\components\\Word-admin.vue?vue&type=style&index=0&id=23c46e10&lang=scss&scoped=true&","dependencies":[{"path":"D:\\aa-tong\\my-projects\\railway-admin\\src\\components\\Word-admin.vue","mtime":1616049865674},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\aa-tong\\my-projects\\railway-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLndvcmQtYWRtaW4tY29udGFpbmVyIHsKICBwYWRkaW5nOiAyMHB4OwogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7CiAgYm9yZGVyLXJhZGl1czogNnB4OwoKICAudXBsb2FkLWltZ3MgewogICAgd2lkdGg6IDEwMCU7CiAgICBtYXJnaW4tYm90dG9tOiAxMHB4OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgZGlzcGxheTogZmxleDsKCiAgICAuYWRkIHsKICAgICAgd2lkdGg6IDEwMHB4OwogICAgICBoZWlnaHQ6IDEwMHB4OwogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7CiAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsKICAgICAgZGlzcGxheTogZmxleDsKCiAgICAgIC5hZGRJY29uIHsKICAgICAgICB3aWR0aDogNTBweDsKICAgICAgICBoZWlnaHQ6IDUwcHg7CiAgICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICAgIHRvcDogNDUlOwogICAgICAgIGxlZnQ6IDQ1JTsKICAgICAgICB6LWluZGV4OiAxOwogICAgICB9CgogICAgICAuaW5wdXRVcGxvYWQgewogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICB3aWR0aDogMTAwcHg7CiAgICAgICAgaGVpZ2h0OiAxMDBweDsKICAgICAgICBvcGFjaXR5OiAwOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICB6LWluZGV4OiA5OTk7CiAgICAgIH0KICAgIH0KCiAgICAuc3BhblN0eWxlIHsKICAgICAgd2lkdGg6IDE1cHg7CiAgICAgIGhlaWdodDogMTVweDsKICAgICAgcG9zaXRpb246IGFic29sdXRlOwogICAgICB0b3A6IDFweDsKICAgICAgcmlnaHQ6IDFweDsKICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICBsaW5lLWhlaWdodDogMTsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDIyMSwgMjIxLCAyMjEpOwogICAgICBjb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpOwogICAgICBib3JkZXI6IDFweCBzb2xpZCByZ2IoMjIxLCAyMjEsIDIyMSk7CiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsKICAgICAgei1pbmRleDogOTk5OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICB9CgogICAgLnByZXZpZXdJbWcgewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICB6LWluZGV4OiAxOwogICAgfQogIH0KCiAgLnFyX2ltZyB7CiAgICAvL+WbvueJh+acieeZvei+ueWhq+WFhWNzcwogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgd2lkdGg6IDIwMHB4OwogICAgaGVpZ2h0OiAyMDBweDsKCiAgICBpbWcgewogICAgICB3aWR0aDogMjAwcHg7CiAgICAgIGhlaWdodDogMjAwcHg7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7IC8v6K6+572u55m96Imy6IOM5pmv6ImyCiAgICAgIHBhZGRpbmc6IDZweDsgLy8g5Yip55SocGFkZGluZ+eahOeJueaAp++8jOaMpOWHuueZvei+uQogICAgfQogIH0KfQo="},{"version":3,"sources":["Word-admin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwiBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Word-admin.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"word-admin-container\">\r\n    <!-- <h1>文档管理</h1> -->\r\n    <div style=\"height: 40px;line-height: 40px;text-align: left;\">\r\n      <span style=\"display: inline-block;width: 80px;color: #606266;font-size: 14px;\">上传时间：</span>\r\n      <el-date-picker v-model=\"time\" type=\"daterange\" range-separator=\"至\" start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\" format=\"yyyy-MM-dd\" value-format=\"yyyy-MM-dd\">\r\n      </el-date-picker>\r\n      <el-input style=\"width: 330px;margin-left: 10px;\" v-model=\"keyword\" placeholder=\"可输入文档名称进行搜索\">\r\n      </el-input>\r\n      <el-button style=\"margin-left: 10px;\" type=\"primary\" @click=\"wordCheck\">查 询</el-button>\r\n      <el-button type=\"primary\" @click=\"addWord\">+ 新 建</el-button>\r\n\r\n      <el-dialog title=\"添加文档\" :visible.sync=\"dialogAddWordVisible\" :close-on-press-escape=\"false\"\r\n        :close-on-click-modal=\"false\" :modal-append-to-body=\"false\" :append-to-body=\"false\">\r\n        <el-form :model=\"wordForm\" ref=\"wordFormRef\">\r\n          <el-form-item label=\"文档名称：\" required>\r\n            <div style=\"display: flex;\">\r\n              <el-input v-model=\"wordForm.name\" placeholder=\"请输入\" style=\"width: 100%;\"></el-input>\r\n            </div>\r\n          </el-form-item>\r\n          <el-form-item label=\"文档文件：\" required>\r\n            <div style=\"display:flex;\">\r\n              <div class=\"upload-imgs\">\r\n                <div class=\"add\">\r\n                  <form enctype=\"multipart/form-data\" style=\"width: 100px;\">\r\n                    <input @change=\"inputChange($event)\" ref=\"uploadImgRef\" type=\"file\" name=\"fileName\"\r\n                      accept=\"image/*,.pptx,.xlsx,.pdf,.doc,.docx,.xml,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/pdf\"\r\n                      class=\"inputUpload\" />\r\n                    <i class=\"el-icon-plus addIcon\"></i>\r\n                  </form>\r\n                </div>\r\n                <div style=\"display:flex;position:relative;flex-wrap: wrap;\" id=\"delImg\" class=\"delImg\">\r\n                  <div v-for=\"(imgurl, index) of imgurls\" :key=\"index\" style=\"margin-left:10px;position:relative;\">\r\n                    <span v-if=\"imgurl !== '' && imgurl !== null\" class=\"spanStyle\" @click=\"delImage(index)\">x</span>\r\n                    <img v-if=\"imgurl !== '' && imgurl !== null\" :src=\"imgFilter(imgurl)\" width=\"100px\" height=\"100px\"\r\n                      style=\"border-radius:5px;object-fit:cover;\" />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\">\r\n          <el-button @click=\"dialogAddWordVisible = false\">取 消</el-button>\r\n          <el-button type=\"primary\" @click=\"addWordSure\" v-preventClick>确 定</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </div>\r\n    <div style=\"margin-top: 20px;\">\r\n      <el-table :data=\"wordList\" style=\"width: 980px\" border>\r\n        <el-table-column prop=\"name\" label=\"文件名称\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"time\" label=\"上传时间\">\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\">\r\n          <template slot-scope=\"scope\">\r\n            <div>\r\n              <el-button type=\"text\" @click=\"qrcodeLook(scope.row)\">二维码预览</el-button>\r\n              <el-dialog title=\"二维码预览\" :visible.sync=\"dialogQrcodeLookVisible\" :close-on-press-escape=\"false\"\r\n                :close-on-click-modal=\"false\" :modal-append-to-body=\"false\" :append-to-body=\"false\">\r\n                <div style=\"text-align: center;\">\r\n                  <div class=\"qr_img\" id=\"qrcode\" ref=\"qrcode\"></div>\r\n                </div>\r\n                <div slot=\"footer\">\r\n                  <el-button @click=\"dialogQrcodeLookVisible = false\">取 消</el-button>\r\n                  <el-button type=\"primary\" @click=\"dialogQrcodeLookVisible = false\">确 定</el-button>\r\n                </div>\r\n              </el-dialog>\r\n              <el-button style=\"margin-left: 30px;\" type=\"text\" @click=\"createPicture(scope.row)\">\r\n                <div style=\"display: none;\" class=\"qr_img\" id=\"qrcode2\" ref=\"qrcode2\"> </div>二维码下载\r\n              </el-button>\r\n              <el-button style=\"margin-left: 30px;\" type=\"text\" @click=\"updateWord(scope.row)\">详情</el-button>\r\n              <el-dialog title=\"修改文档\" :visible.sync=\"dialogUpdateWordVisible\" :close-on-press-escape=\"false\"\r\n                :close-on-click-modal=\"false\" :modal-append-to-body=\"false\" :append-to-body=\"false\">\r\n                <el-form :model=\"wordForm\">\r\n                  <el-form-item label=\"文档名称：\" required>\r\n                    <div style=\"display: flex;\">\r\n                      <el-input v-model=\"wordForm.name\" placeholder=\"请输入\" style=\"width: 100%;\"></el-input>\r\n                    </div>\r\n                  </el-form-item>\r\n                  <el-form-item label=\"文档文件：\" required>\r\n                    <div style=\"display:flex;\">\r\n                      <div class=\"upload-imgs\">\r\n                        <div class=\"add\">\r\n                          <form enctype=\"multipart/form-data\" style=\"width: 100px;\">\r\n                            <input @change=\"inputChange($event)\" ref=\"uploadImgRef\" type=\"file\" name=\"fileName\"\r\n                              accept=\"image/*,.pptx,.xlsx,.pdf,.doc,.docx,.xml,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/pdf\"\r\n                              class=\"inputUpload\" />\r\n                            <i class=\"el-icon-plus addIcon\"></i>\r\n                          </form>\r\n                        </div>\r\n                        <div style=\"display:flex;position:relative;flex-wrap: wrap;\" id=\"delImg\" class=\"delImg\">\r\n                          <div v-for=\"(imgurl, index) of imgurls\" :key=\"index\"\r\n                            style=\"margin-left:10px;position:relative;cursor: pointer;\">\r\n                            <span v-if=\"imgurl !== '' && imgurl !== null\" class=\"spanStyle\"\r\n                              @click=\"delImage(index)\">x</span>\r\n                            <img v-if=\"imgurl !== '' && imgurl !== null\" :src=\"imgFilter(imgurl)\" width=\"100px\"\r\n                              height=\"100px\" style=\"border-radius:5px;object-fit:cover;\" @click=\"downWord(imgurl)\" />\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </el-form-item>\r\n                </el-form>\r\n                <div slot=\"footer\">\r\n                  <el-button @click=\"dialogUpdateWordVisible = false\">取 消</el-button>\r\n                  <el-button type=\"primary\" @click=\"updateWordSure\" v-preventClick>确 定</el-button>\r\n                </div>\r\n              </el-dialog>\r\n              <el-button style=\"margin-left: 30px;color: red;\" type=\"text\" @click=\"deteleWord(scope.row)\">删除</el-button>\r\n              <el-dialog title=\"删除文档\" :visible.sync=\"dialogDeleteWordVisible\" :close-on-press-escape=\"false\"\r\n                :close-on-click-modal=\"false\" :modal-append-to-body=\"false\" :append-to-body=\"false\">\r\n                <div style=\"text-align: center;\">\r\n                  <p style=\"margin: 10px 0 0;font-size: 16px;color: #4e4e4e;\">确定删除该文档？删除后不可修改</p>\r\n                </div>\r\n                <div slot=\"footer\">\r\n                  <el-button @click=\"dialogDeleteWordVisible = false\">取 消</el-button>\r\n                  <el-button type=\"primary\" @click=\"deteleWordSure\" v-preventClick>确 定</el-button>\r\n                </div>\r\n              </el-dialog>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div style=\"width: 980px;height: 50px;position: relative;\">\r\n        <div style=\"margin:15px 0;position:absolute;right:0;\">\r\n          <el-pagination @current-change=\"handleCurrentChange\" :current-page=\"page\"\r\n            layout=\"total, prev, pager, next, jumper\" :total=\"total\">\r\n          </el-pagination>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import QRCode from \"qrcodejs2\";\r\n  export default {\r\n    data() {\r\n      return {\r\n        img: this.$store.state.baseUrl,\r\n        time: '',\r\n        keyword: '',\r\n        dialogAddWordVisible: false,\r\n        wordForm: {\r\n          name: ''\r\n        },\r\n        imgurls: [],\r\n\r\n        page: 1,\r\n        pageNum: 10,\r\n        total: 0,\r\n        wordList: [],\r\n        wordTypeList: ['image/jpeg', 'image/png', 'image/jpg', 'image/tif', 'image/bmp', 'image/gif', 'pptx', 'xlsx',\r\n          'xls', 'pdf', 'doc', 'docx', 'application/msword',\r\n          'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n          'application/vnd.openxmlformats-officedocument.presentationml.presentation',\r\n          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n          'application/pdf'\r\n        ],\r\n        imgType1: ['jpeg', 'png', 'jpg', 'tif', 'bmp', 'gif'],\r\n        imgType2: ['xlsx', 'xls'],\r\n        imgType3: ['doc', 'docx'],\r\n        imgTypeImg1: require('../assets/imgs/word/PowerPoint-icon.png'),\r\n        imgTypeImg2: require('../assets/imgs/word/Excel-icon.png'),\r\n        imgTypeImg3: require('../assets/imgs/word/pdf.png'),\r\n        imgTypeImg4: require('../assets/imgs/word/Word-icon.png'),\r\n        dialogQrcodeLookVisible: false,\r\n        qrcode: '',\r\n        urlValue: \"\", // 生成二维码的内容\r\n\r\n        dialogUpdateWordVisible: false,\r\n        updateWordDetails: {},\r\n\r\n        dialogDeleteWordVisible: false,\r\n        deleteWordDetails: {},\r\n\r\n      }\r\n    },\r\n    created() {\r\n      this.wordCheck();\r\n    },\r\n    methods: {\r\n      // 删除文档\r\n      deteleWord(row) {\r\n        this.deleteWordDetails = row;\r\n        this.dialogDeleteWordVisible = true;\r\n      },\r\n      // 确定\r\n      deteleWordSure() {\r\n        this.$axios.post(this.$store.state.baseUrl + '/ruleDelete', {\r\n          id: this.deleteWordDetails.id\r\n        }).then(res => {\r\n          console.log('删除文档');\r\n          console.log(res);\r\n          this.$message.success({\r\n            message: \"删除成功\",\r\n            showClose: true,\r\n            duration: 2000,\r\n          });\r\n          this.dialogDeleteWordVisible = false;\r\n          this.wordCheck();\r\n        }).catch(err => {\r\n          console.log(err);\r\n          this.$message.success({\r\n            message: err.data.message,\r\n            showClose: true,\r\n            duration: 2000,\r\n          });\r\n          this.dialogDeleteWordVisible = false;\r\n        })\r\n      },\r\n      // 修改文档\r\n      updateWord(row) {\r\n        this.updateWordDetails = row;\r\n        this.wordForm.name = '';\r\n        this.imgurls = [];\r\n        this.wordForm.name = this.updateWordDetails.name;\r\n        if (this.updateWordDetails.url !== null && this.updateWordDetails.url !== \"\") {\r\n          if (this.updateWordDetails.url.indexOf(\"|\") !== -1) {\r\n            this.imgurls = this.updateWordDetails.url.split(\"|\");\r\n          } else {\r\n            this.imgurls.push(this.updateWordDetails.url);\r\n          }\r\n        } else {\r\n          this.imgurls = [];\r\n        }\r\n        console.log(this.imgurls);\r\n        this.dialogUpdateWordVisible = true;\r\n      },\r\n      // 确定\r\n      updateWordSure() {\r\n        this.$axios.post(this.$store.state.baseUrl + '/ruleSave', {\r\n          id: this.updateWordDetails.id,\r\n          name: this.wordForm.name,\r\n          url: this.imgurls.join('|')\r\n        }).then(res => {\r\n          console.log('修改文档');\r\n          console.log(res);\r\n          this.$message.success({\r\n            message: \"修改成功\",\r\n            showClose: true,\r\n            duration: 2000,\r\n          });\r\n          this.dialogUpdateWordVisible = false;\r\n          this.wordCheck();\r\n        }).catch(err => {\r\n          console.log(err);\r\n          this.$message.success({\r\n            message: err.data.message,\r\n            showClose: true,\r\n            duration: 2000,\r\n          });\r\n          this.dialogUpdateWordVisible = false;\r\n        })\r\n      },\r\n      // 修改时文档直接下载\r\n      downWord(imgurl) {\r\n        console.log(imgurl);\r\n        let eurl = this.$store.state.baseUrl + '/file/' + imgurl;\r\n        console.log(eurl);\r\n        if (this.imgType1.indexOf(imgurl.split('.')[1]) == -1) {\r\n          window.location.href = eurl;\r\n        } else {\r\n          window.open(eurl)\r\n        }\r\n      },\r\n      // 文件预览\r\n      imgFilter(url) {\r\n        if (this.imgType1.indexOf(url.split('.')[1]) !== -1) {\r\n          return this.img + '/file/' + url\r\n        } else if (url.split('.')[1].indexOf('pptx') !== -1) {\r\n          return this.imgTypeImg1\r\n        } else if (this.imgType2.indexOf(url.split('.')[1]) !== -1) {\r\n          return this.imgTypeImg2\r\n        } else if (url.split('.')[1].indexOf('pdf') !== -1) {\r\n          return this.imgTypeImg3\r\n        } else if (this.imgType3.indexOf(url.split('.')[1]) !== -1) {\r\n          return this.imgTypeImg4\r\n        }\r\n      },\r\n      // 二维码预览\r\n      qrcodeLook(row) {\r\n        console.log(row);\r\n        this.dialogQrcodeLookVisible = true;\r\n        this.$axios.post(this.$store.state.baseUrl + '/pdfUrlGet', {\r\n          id: row.id\r\n        }).then(res => {\r\n          console.log('文档详情');\r\n          console.log(res);\r\n          // this.urlValue = 'http://192.168.0.119:8080/#/img/' + row.id;\r\n          this.urlValue = 'http://train.wistechx.cn/app/Yumo/FileView/#/?id=' + row.id;\r\n\r\n          this.$nextTick(() => {\r\n            this.createQr();\r\n          });\r\n        })\r\n      },\r\n      // 生成二维码\r\n      createQr() {\r\n        let _this = this;\r\n        //生成前先清空二维码\r\n        console.log(document.getElementById(\"qrcode\"));\r\n        document.getElementById(\"qrcode\").innerHTML = \"\";\r\n        console.log(this.$refs.qrcode);\r\n        this.$refs.qrcode.innerHTML = \"\";\r\n        this.qrcode = new QRCode(_this.$refs.qrcode, {\r\n          width: 200, // 宽\r\n          height: 200, //高\r\n          text: _this.urlValue, //生成二维码的内容\r\n          render: \"canvas\", //设置渲染方式（canvas,table 默认canvas）\r\n          correctLevel: QRCode.CorrectLevel.L //二维码纠错级别（L,M,Q,H）\r\n        });\r\n      },\r\n      // 生成图片并下载\r\n      createPicture(row) {\r\n        console.log(row);\r\n        this.$axios.post(this.$store.state.baseUrl + '/pdfUrlGet', {\r\n          id: row.id\r\n        }).then(res => {\r\n          console.log('文档详情');\r\n          console.log(res);\r\n          // this.urlValue = 'http://192.168.0.119:8080/#/img/' + row.id;\r\n          this.urlValue = 'http://train.wistechx.cn/app/Yumo/FileView/#/?id=' + row.id;\r\n\r\n          let _this = this;\r\n          //生成前先清空二维码\r\n          this.$nextTick(() => {\r\n            document.getElementById(\"qrcode2\").innerHTML = \"\";\r\n            console.log(document.getElementById(\"qrcode2\"));\r\n            console.log(this.$refs.qrcode2);\r\n            // this.$refs.qrcode2.innerHTML = \"\";\r\n            this.qrcode = new QRCode(document.getElementById(\"qrcode2\"), {\r\n              width: 1000, // 宽\r\n              height: 1000, //高\r\n              text: _this.urlValue, //生成二维码的内容\r\n              render: \"canvas\", //设置渲染方式（canvas,table 默认canvas）\r\n              correctLevel: QRCode.CorrectLevel.L //二维码纠错级别（L,M,Q,H）\r\n            });\r\n\r\n            let canvasData = document.getElementById(\"qrcode2\").getElementsByTagName('canvas');\r\n            let imgData = canvasData[0].toDataURL(\"image/png\"); // 获得图片base64\r\n\r\n            if (window.navigator.msSaveOrOpenBlob) { //IE浏览器：创建blob对象\r\n              console.log(imgData);\r\n              let bstr = atob(imgData.split(\",\")[1]);\r\n              let n = bstr.length;\r\n              let u8arr = new Uint8Array(n);\r\n              while (n--) {\r\n                u8arr[n] = bstr.charCodeAt(n);\r\n              }\r\n              let blob = new Blob([u8arr]);\r\n              window.navigator.msSaveOrOpenBlob(blob, \"二维码\" + \".\" + \"png\");\r\n            } else { // 非ie浏览器\r\n              let a = document.createElement(\"a\");\r\n              a.href = imgData;\r\n              a.download = \"二维码\";\r\n              a.click();\r\n            }\r\n          })\r\n\r\n        })\r\n      },\r\n      // 新建文档\r\n      addWord() {\r\n        this.wordForm.name = '';\r\n        this.imgurls = [];\r\n        this.dialogAddWordVisible = true;\r\n      },\r\n      // 确定\r\n      addWordSure() {\r\n        console.log(this.wordForm.name);\r\n        if (this.wordForm.name !== '' && this.imgurls.length !== 0) {\r\n          this.$axios.post(this.$store.state.baseUrl + '/ruleSave', {\r\n            name: this.wordForm.name,\r\n            url: this.imgurls.join('|')\r\n          }).then(res => {\r\n            console.log('上传文档');\r\n            console.log(res);\r\n            this.$message.success({\r\n              message: \"文档上传成功\",\r\n              showClose: true,\r\n              duration: 2000,\r\n            });\r\n            this.dialogAddWordVisible = false;\r\n            this.time = '';\r\n            this.keyword = '';\r\n            this.handleCurrentChange(1);\r\n          }).catch(err => {\r\n            console.log(err);\r\n            this.$message.error({\r\n              message: err.data.message,\r\n              showClose: true,\r\n              duration: 2000,\r\n            });\r\n            this.dialogAddWordVisible = false;\r\n          })\r\n        } else {\r\n          this.$message.error({\r\n            message: '数据不能为空',\r\n            showClose: true,\r\n            duration: 2000,\r\n          });\r\n        }\r\n      },\r\n      // 上传文件\r\n      inputChange(e) {\r\n        console.log(this.imgurls);\r\n        let file = e.target.files[0];\r\n        console.log(file);\r\n        if (file !== undefined) {\r\n          if (this.wordTypeList.indexOf(file.type) == -1) {\r\n            this.$message.error({\r\n              message: '文件类型错误，仅可上传图片、word、Excel、PPT、PDF等格式文件',\r\n              showClose: true,\r\n              duration: 2000\r\n            });\r\n            return\r\n          };\r\n          // 已上传的文件是图片，并且新上传的不是图片\r\n          if (this.imgurls.length !== 0 && this.imgType1.indexOf(this.imgurls[0].split('.')[1]) !== -1 && file.type\r\n            .indexOf('image') == -1) {\r\n            this.$message.warning({\r\n              message: '文件类型唯一，不可混合上传',\r\n              showClose: true,\r\n              duration: 2000\r\n            });\r\n            return\r\n          } else if (this.imgurls.length !== 0 && this.imgType2.indexOf(this.imgurls[0].split('.')[1]) !== -1 && file\r\n            .type.indexOf('application/vnd.openxmlformats-officedocument.spreadsheetml.sheet') == -1) {\r\n            this.$message.warning({\r\n              message: '文件类型唯一，不可混合上传',\r\n              showClose: true,\r\n              duration: 2000\r\n            });\r\n            return\r\n          } else if (this.imgurls.length !== 0 && this.imgType3.indexOf(this.imgurls[0].split('.')[1]) !== -1 && file\r\n            .type.indexOf('application/vnd.openxmlformats-officedocument.wordprocessingml.document') == -1) {\r\n            this.$message.warning({\r\n              message: '文件类型唯一，不可混合上传',\r\n              showClose: true,\r\n              duration: 2000\r\n            });\r\n            return\r\n          }\r\n          if (this.imgurls.length !== 0 && file.name.split('.')[1] == 'pdf') {\r\n            if (this.imgurls.length !== 0 && file.name.split('.')[1] !== this.imgurls[0].split('.')[1]) {\r\n              this.$message.warning({\r\n                message: '文件类型唯一，不可混合上传',\r\n                showClose: true,\r\n                duration: 2000\r\n              });\r\n              return\r\n            }\r\n          } else if (this.imgurls.length !== 0 && file.name.split('.')[1] == 'pptx') {\r\n            if (this.imgurls.length !== 0 && file.name.split('.')[1] !== this.imgurls[0].split('.')[1]) {\r\n              this.$message.warning({\r\n                message: '文件类型唯一，不可混合上传',\r\n                showClose: true,\r\n                duration: 2000\r\n              });\r\n              return\r\n            }\r\n          };\r\n          if (this.imgurls.length !== 0 && this.imgType1.indexOf(this.imgurls[0].split('.')[1]) == -1) {\r\n            this.$message.warning({\r\n              message: '非图片文件只可上传一个',\r\n              showClose: true,\r\n              duration: 2000\r\n            });\r\n          } else {\r\n            this.uploadLice(file);\r\n          }\r\n        }\r\n      },\r\n      //  返回file文件，调用接口执行上传\r\n      uploadLice(file) {\r\n        console.log(file);\r\n        let formdata = new FormData(); //创建form对象\r\n        formdata.append(\"file\", file); //通过append向form对象添加数据\r\n        this.uploadImg(formdata);\r\n      },\r\n      uploadImg(formdata) {\r\n        this.$axios\r\n          .post(this.$store.state.baseUrl + \"/upload\", formdata)\r\n          .then((res) => {\r\n            if (res.status == 200) {\r\n              this.$message.success({\r\n                message: \"文件上传成功\",\r\n                showClose: true,\r\n                duration: 2000,\r\n              });\r\n            }\r\n            console.log(res);\r\n            let imgurl = res.data.fileName;\r\n            if (this.imgurls.indexOf(imgurl) == -1) {\r\n              this.imgurls.push(imgurl);\r\n            };\r\n            console.log(this.imgurls);\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n            this.$message.error({\r\n              message: err.data.message,\r\n              showClose: true,\r\n              duration: 2000,\r\n            });\r\n          });\r\n      },\r\n      // 删除图片\r\n      delImage(index) {\r\n        this.imgurls.splice(index, 1);\r\n        this.$refs.uploadImgRef.value = '';\r\n      },\r\n      // 模糊搜索文档\r\n      wordCheck() {\r\n        console.log(this.time);\r\n        this.$axios.post(this.$store.state.baseUrl + '/ruleList', {\r\n          startTime: this.time == null ? '' : this.time[0],\r\n          endTime: this.time == null ? '' : this.time[1],\r\n          keyword: this.keyword,\r\n          page: this.page,\r\n          pageNum: this.pageNum\r\n        }).then(res => {\r\n          console.log('文档列表');\r\n          console.log(res);\r\n          this.wordList = res.data.list;\r\n          this.total = res.data.total;\r\n        }).catch(err => {\r\n          console.log(err);\r\n        })\r\n      },\r\n      // 分页\r\n      handleCurrentChange(val) {\r\n        console.log(`当前页: ${val}`);\r\n        this.page = val;\r\n        (function smoothscroll() {\r\n          let currentScroll =\r\n            document.documentElement.scrollTop || document.body.scrollTop;\r\n          if (currentScroll > 0) {\r\n            window.requestAnimationFrame(smoothscroll);\r\n            window.scrollTo(0, currentScroll - currentScroll / 5);\r\n          }\r\n        })();\r\n        this.wordCheck();\r\n      },\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .word-admin-container {\r\n    padding: 20px;\r\n    background-color: #fff;\r\n    border-radius: 6px;\r\n\r\n    .upload-imgs {\r\n      width: 100%;\r\n      margin-bottom: 10px;\r\n      position: relative;\r\n      display: flex;\r\n\r\n      .add {\r\n        width: 100px;\r\n        height: 100px;\r\n        position: relative;\r\n        border: 1px solid #ddd;\r\n        border-radius: 5px;\r\n        display: flex;\r\n\r\n        .addIcon {\r\n          width: 50px;\r\n          height: 50px;\r\n          position: absolute;\r\n          top: 45%;\r\n          left: 45%;\r\n          z-index: 1;\r\n        }\r\n\r\n        .inputUpload {\r\n          position: absolute;\r\n          display: block;\r\n          width: 100px;\r\n          height: 100px;\r\n          opacity: 0;\r\n          cursor: pointer;\r\n          z-index: 999;\r\n        }\r\n      }\r\n\r\n      .spanStyle {\r\n        width: 15px;\r\n        height: 15px;\r\n        position: absolute;\r\n        top: 1px;\r\n        right: 1px;\r\n        text-align: center;\r\n        line-height: 1;\r\n        background-color: rgb(221, 221, 221);\r\n        color: rgb(255, 255, 255);\r\n        border: 1px solid rgb(221, 221, 221);\r\n        border-radius: 50%;\r\n        z-index: 999;\r\n        cursor: pointer;\r\n      }\r\n\r\n      .previewImg {\r\n        display: flex;\r\n        z-index: 1;\r\n      }\r\n    }\r\n\r\n    .qr_img {\r\n      //图片有白边填充css\r\n      display: inline-block;\r\n      width: 200px;\r\n      height: 200px;\r\n\r\n      img {\r\n        width: 200px;\r\n        height: 200px;\r\n        background-color: #fff; //设置白色背景色\r\n        padding: 6px; // 利用padding的特性，挤出白边\r\n      }\r\n    }\r\n  }\r\n</style>"]}]}